\newpage
%\begin{algorithm}[H]
%    \DontPrintSemicolon
%    \SetKwFunction{FLinkmodel}{Linkmodel}
%    \SetKwProg{Fn}{Function}{}{}
%
%    \Fn{\FLinkmodel{links}}{
%        \ForEach{$l \in $ links}{
%            neighbours $\leftarrow$ findNeighbourhood($l$)\;
%            \ForEach{$neighbour \in neighbours$}{
%                C $\leftarrow r(l, neighbour)$ // The autocorrelation %function\;
%
%                $\Sigma \leftarrow \sigma^2$C // The covariance matrix\;
%            }
%        }
%    }
%
%    \caption{Pseoducode for the linkmodel}
%    \label{algo:linkmodel}
%\end{algorithm}





\begin{algorithm}[H]
    \DontPrintSemicolon
    \SetKwFunction{FLinkmodel}{Linkmodel}
    \SetKwProg{Fn}{Function}{}{}

    \Fn{\FLinkmodel{links}}{
        model $\leftarrow$ An unordered map with id as key and RSSI as value\;\;

        \ForEach{link1 $\in$ links}{
            fading $\leftarrow$ 0\;

            \ForEach{link2 $\in$ links}{
                \If{!$hasCommonNode$(link1, link2)}{
                    \KwContinue\;
                }
                \ElseIf{link1 $=$ link2}{
                    corr $\leftarrow$ 1\;
                }
                \Else{
                    angle $\leftarrow \theta$(link1, link2)\;
                    corr $\leftarrow$ $r$(angle)\;
                }
                
                
                ran $\leftarrow$ Pick a random value from a gaussian distribution with mean $=$ 0, and standard deviation $=$ 1\;
                fading $\leftarrow$ fading + ran $\cdot$ corr\;

            }
            %\tcp{distanceFading $\leftarrow l_d$($d$(link1))}
            model[link1.id] = $tx_{power}$ - (fading)\;
        }
    }
    \caption{Pseoducode for the linkmodel}
    \label{algo:linkmodel}
\end{algorithm}

$d(link)$ computes the distance of a link.\\
$\theta(link1, link2)$ computes the angle between two links.\\
$r(angle)$ is the autocorrelation function.\\
$hasCommonNode(link1, link2)$ is a function checking if the links share a node.\\
%$l_d(distance)$ computes the pathloss for the distance dependent part.

%\begin{algorithm}[H]
%    \DontPrintSemicolon
%    \SetKwFunction{FCorrelation}{Correlation}
%    \SetKwProg{Fn}{Function}{}{}
%
%    \Fn{\FCorrelation{angle}}{
%        \If{angle > 180}{
%            angle $\leftarrow$ 360 - angle\;
%        }
%
%        \Return angle / 180\;
%    }
%
%    \caption{Pseoducode for the Correlation}
%    \label{algo:correlation_func}
%\end{algorithm}