
\section{Slotted ALOHA}\label{sec:saloha}
\todo[inline]{Make sure code is up to date!}
%In this section we will present an implementation of the Slotted ALOHA protocol~\cite{Roberts:1975:APS:1024916.1024920}, using the hardware interface from \autoref{sec:hardwareinterface}. 
Slotted ALOHA~\cite{Roberts:1975:APS:1024916.1024920} is a \gls{tdma} protocol, that enable communication between nodes in a wireless network, by randomly selecting a time slot to transmit, while listening in every other time slot. Pseudo code describing the Slotted ALOHA protocol can be seen in \autoref{algo:slottedaloha}. This method of selecting time slots for transmitting will have a high probability of collisions happening, where multiple nodes transmit at the same time, which make this protocol an ideal candidate for simulating collisions and packet loss.\medbreak

%An important part of any \gls{tdma} protocol is that only a single node should transmit at a given timeslot, otherwise collisions will occur. Thus, the Slotted ALOHA protocol is a good choice for 
% TODO: Add number of arguments as parameter
\begin{algorithm}[ht]
    \DontPrintSemicolon
    \SetKwFunction{FSlottedALOHA}{Slotted ALOHA}
    \SetKwProg{Fn}{procedure}{}{}

    \Fn{\FSlottedALOHA{S}}{
        \Repeat{\textit{protocol terminates}}{
            selected $\leftarrow$ randomly select a slot $\in$ {1, 2, \dots, S}\;

            \ForEach{current $\in$ {1, 2, \dots, S}}{
                \If{select = current}{
                    duration $\leftarrow$ Broadcast(select)\;
                    Sleep(200us - duration)\;
                }
                \Else{
                    packets $\leftarrow$ Listen(200us)\;
                }
            }
        }
    }

    \caption{The Slotted ALOHA protocol~\cite{Roberts:1975:APS:1024916.1024920}.}
    \label{algo:slottedaloha}
\end{algorithm}

\todo[inline]{At some point, we should be able to create a graph to measure received packets and collisions for the Slotted ALOHA protocol.}



%\begin{table}[H]
%    \begin{tabular}{|l|l|l|l|l|l|l|l|l|l|l|l|l|}
%        \hline
%        \diagbox{Sleep}{Slots} & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12 & 13 & %14 & 15 & 16 \\ \hline
%                               &   &   &   &   &   &    &    &    &    &   % &    &    \\ \hline
%        30 seconds             &   &   &   &   &   &    &    &    &    &   % &    &    \\ \hline
%        1 minute               &   &   &   &   &   &    &    &    &    &   % &    &    \\ \hline
%        2 minutes              &   &   &   &   &   &    &    &    &    &   % &    &    \\ \hline
%        5 minutes              &   &   &   &   &   &    &    &    &    &   % &    &    \\ \hline
%        %&   &   &   &   &   &    &    &    &    &    &    &    \\ \hline
%    \end{tabular}
%    \caption{Results from running the ALOHA protocol with different %parameters.}
%    \label{table:experiments:aloha-results}
%\end{table}


%\begin{table}[H]
%    \begin{tabular}{|c|l|l|l|l|l|}
%        \hline
%        \diagbox{Slots}{Sleep} & \multicolumn{1}{c|}{10 seconds} & %\multicolumn{1}{c|}{30 seconds} & \multicolumn{1}{c|}{1 minute} & %\multicolumn{1}{c|}{2 minutes} & \multicolumn{1}{c|}{5 minutes} \\ %\hline
%        \multirow{2}{*}{5}     & R: 30~s                         & R: 40~s  %                       & R: 3~m                        & R: 45~s    %                    & R: 7~s                         \\
%                               & V: 6~h, 48~m                    & V: 20 h, %24 m                   & V: 40 h, 48 m       %          & V: 81 h, 36 m                  & %V: 204 h                       \\ \hline
%        \multirow{2}{*}{6}     & R: 2~s                          & R: 22~ms %                       & R: 20~ms                      & R: 16~ms   %                    & R: 12~ms                       \\
%                               & V: 0                            & V: 1     %                       & V: 1                %          & V: 1                           & %V: 1                           \\ \hline
%        \multirow{2}{*}{7}     & R: 33~ms                        & R: 15~ms %                       & R: 5~ms                       & R: 23~ms   %                    & R: 23~ms                       \\
%                               & V: 1                            & V: 1     %                       & V: 0                %          & V: 1                           & %V: 1                           \\ \hline
%        \multirow{2}{*}{8}     & R: 16~ms                        & R: 16~ms %                       & R: 11~ms                      & R: 17~ms   %                    & R: 12~ms                       \\
%                               & V: 1                            & V: 1     %                       & V: 0                %          & V: 0                           & %V: 0                           \\ \hline
%        \multirow{2}{*}{9}     & R: 12~s                         & R: 18~ms %                       & R: 38~ms                      & R: 24~ms   %                    & R: 21~ms                       \\
%                               & V: 31                           & V: 0     %                       & V: 0                %          & V: 0                           & %V: 0                           \\ \hline
%
%        \multirow{2}{*}{10}    & R: 3~s                          & R: 44~ms %                       & R: 18~ms                      & R: 13~ms   %                    & R: 12~ms                       \\
%                               & V: 1                            & V: 1     %                       & V: 0                %          & V: 0                           & %V: 1                           \\ \hline
%
%        \multirow{2}{*}{11}    & R: 4~s                          & R: 15~ms %                       & R: 20~ms                      & R: 21~ms   %                    & R: 11~ms                       \\
%                               & V: 1                            & V: 0     %                       & V: 0                %          & V: 1                           & %V: 0                           \\ \hline
%
%        \multirow{2}{*}{12}    & R: 3~s                          & R: 19~ms %                       & R: 14~ms                      & R: 9~ms    %                    & R: 11~ms                       \\
%                               & V: 1                            & V: 0     %                       & V: 1                %          & V: 1                           & %V: 0                           \\ \hline
%    \end{tabular}
%    \caption{Results from running the ALOHA protocol with different %parameters.}
%    \label{table:experiments:aloha-results}
%\end{table}


\begin{table}[H]
    \begin{tabular}{|l|l|l|l|l|l|l|l|l|}
        \hline
        \diagbox{Time}{Slots} & 5    & 6   & 7    & 8    & 9    & 10    & 11   & 12   \\ \hline
        Real                  & 45 s & 5 s & 90 s & 60 s & 50 s & 105 s & 60 s & 88 s \\ \hline
        %        Virtual               & 6h, 48 m & 5 h, 36 m & 4 h, 48 m & 4 h, 15 m& 3 h, 42 m&    &    & 2 h, 48m   \\ \hline
    \end{tabular}
    \caption{Real time results from running the ALOHA protocol with different total time slots.}
    \label{table:experiments:aloha-results}
\end{table}